var e,t,s,i,n;e=module.exports,Object.defineProperty(e,"__esModule",{value:!0,configurable:!0}),t=module.exports,s="default",i=()=>A,Object.defineProperty(t,s,{get:i,set:n,enumerable:!0,configurable:!0});var r={arrowUp:'<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 25 25" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 15l-6-6-6 6"/></svg>',arrowDown:'<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 25 25" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 9l6 6 6-6"/></svg>',arrowRight:'<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 25 25" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18l6-6-6-6"/></svg>',attention:'<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 25 25" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>',clear:'<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 25 25" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>',cross:'<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 25 25" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>',check:'<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 25 25" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>',partialCheck:'<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 25 25" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"></line></svg>'};var l=class{#e;#t;#s;#i;constructor({value:e,showTags:t,tagsCountText:s,clearable:i,isAlwaysOpened:n,searchable:r,placeholder:l,disabled:o}){this.value=e,this.showTags=t,this.tagsCountText=s,this.searchable=r,this.placeholder=l,this.clearable=i,this.isAlwaysOpened=n,this.disabled=o,this.isOpened=!1,this.searchText="",this.#e=this.#n(),this.#t=this.#r(),this.#s=this.#l(),this.#i=null,this.srcElement=this.#o(this.#e,this.#t,this.#s),this.#c()}focus(){this.#t.focus()}blur(){this.isOpened&&this.#a()}updateValue(e){this.value=e,this.#d(),this.#h()}removeItem(e){this.value=this.value.filter((t=>t.id!==e)),this.#u(),this.#d(),this.#h()}clear(){this.value=[],this.searchText="",this.#p(""),this.#u(),this.#d(),this.#h()}openClose(){this.#a()}#c(){this.#d(),this.#h(),this.#m()}#d(){this.#e.innerHTML="",this.showTags?this.#e.append(...this.#v()):this.#e.appendChild(this.#E())}#m(){const e=[];this.#s.innerHTML="",this.clearable&&e.push(this.#w()),this.isAlwaysOpened||e.push(this.#L(this.isOpened)),e.length&&this.#s.append(...e)}#g(){if(!this.isAlwaysOpened&&this.#i){const e=this.isOpened?r.arrowUp:r.arrowDown;this.#i.innerHTML=e}}#h(){this.value?.length?this.#t.removeAttribute("placeholder"):this.#t.setAttribute("placeholder",this.placeholder),this.searchable?this.srcElement.classList.remove("treeselect-input--unsearchable"):this.srcElement.classList.add("treeselect-input--unsearchable"),this.#t.value=this.searchText}#a(){this.isOpened=!this.isOpened,this.#g(),this.isOpened?this.#f():this.#C()}#o(e,t,s){const i=document.createElement("div");return i.classList.add("treeselect-input"),i.setAttribute("tabindex","-1"),i.addEventListener("mousedown",(e=>this.#y(e))),i.append(e,t,s),i}#y(e){e.preventDefault(),this.isOpened||this.#a(),this.focus()}#n(){const e=document.createElement("div");return e.classList.add("treeselect-input__tags"),e}#v(){return this.value.map((e=>{const t=document.createElement("div");t.classList.add("treeselect-input__tags-element"),t.setAttribute("tabindex","-1"),t.setAttribute("tag-id",e.id),t.setAttribute("title",e.name);const s=this.#b(e.name),i=this.#k();return t.addEventListener("mousedown",(t=>this.#T(t,e.id))),t.append(s,i),t}))}#T(e,t){e.preventDefault(),e.stopPropagation(),this.focus(),this.removeItem(t)}#b(e){const t=document.createElement("span");return t.classList.add("treeselect-input__tags-name"),t.innerHTML=e,t}#k(){const e=document.createElement("span");return e.classList.add("treeselect-input__tags-cross"),e.innerHTML=r.cross,e}#E(){const e=document.createElement("span");return e.classList.add("treeselect-input__tags-count"),this.value.length?(e.innerHTML=1===this.value.length?this.value[0].name:`${this.value.length} ${this.tagsCountText}`,e):(e.innerHTML="",e)}#r(){const e=document.createElement("input");return e.classList.add("treeselect-input__edit"),this.disabled&&e.setAttribute("tabindex","-1"),e.addEventListener("keydown",(e=>this.#x(e))),e.addEventListener("input",(t=>this.#_(t,e))),e}#x(e){"Backspace"!==e.key||this.searchText.length||!this.value.length||this.showTags||this.clear(),"Backspace"===e.key&&!this.searchText.length&&this.value.length&&this.removeItem(this.value[this.value.length-1].id),"Space"!==e.code||this.searchText&&this.searchable||this.#a()}#_(e,t){e.stopPropagation();const s=this.searchText,i=t.value.trim();if(0!==s.length||0!==i.length){if(this.searchable){const t=e.target.value;this.#p(t),this.isOpened||this.#a()}else t.value="";this.searchText=t.value}else t.value=""}#l(){const e=document.createElement("div");return e.classList.add("treeselect-input__operators"),e}#w(){const e=document.createElement("span");return e.classList.add("treeselect-input__clear"),e.setAttribute("tabindex","-1"),e.innerHTML=r.clear,e.addEventListener("mousedown",(e=>this.#O(e))),e}#O(e){e.preventDefault(),e.stopPropagation(),this.#t?.focus(),(this.searchText.length||this.value.length)&&this.clear()}#L(e){return this.#i=document.createElement("span"),this.#i.classList.add("treeselect-input__arrow"),this.#i.innerHTML=e?r.arrowUp:r.arrowDown,this.#i.addEventListener("mousedown",(e=>this.#A(e))),this.#i}#A(e){e.stopPropagation(),e.preventDefault(),this.focus(),this.#a()}#u(){this.srcElement.dispatchEvent(new CustomEvent("input",{detail:this.value}))}#p(e){this.srcElement.dispatchEvent(new CustomEvent("search",{detail:e}))}#f(){this.srcElement.dispatchEvent(new CustomEvent("open"))}#C(){this.srcElement.dispatchEvent(new CustomEvent("close"))}};const o=(e,t,s="",i=0)=>e.reduce(((e,n)=>{const r=!!n.children?.length,l=i>=t&&r,c=i>t;if(e.push({id:n.value,name:n.name,childOf:s,isGroup:r,checked:!1,isPartialChecked:!1,level:i,isClosed:l,hidden:c}),r){const s=o(n.children,t,n.value,i+1);e.push(...s)}return e}),[]),c=({id:e,checked:t},s)=>{s.forEach((i=>{i.childOf===e&&(i.checked=t??!0,i.isPartialChecked=!1,i.isGroup&&c(i,s))}))},a=(e,t)=>{const s=t.find((t=>t.id===e)),i=t.filter((e=>e.childOf===s?.id));if(!s)return;const n=i.every((e=>e.checked)),r=i.some((e=>e.isPartialChecked||e.checked))&&!n,l=!n&&!r;n&&(s.checked=!0,s.isPartialChecked=!1),r&&(s.checked=!1,s.isPartialChecked=!0),l&&(s.checked=!1,s.isPartialChecked=!1),s.childOf&&a(s.childOf,t)},d=({id:e,isGroup:t,childOf:s,checked:i},n)=>{t&&c({id:e,checked:i},n),s&&a(s,n)},h=(e,t)=>t.reduce(((s,i)=>(i.childOf===e&&(s.push(i),i.isGroup&&s.push(...h(i.id,t))),s)),[]),u=(e,t)=>t.reduce(((s,i)=>(i.id===e&&(s.push(i),i.childOf&&s.push(...u(i.childOf,t))),s)),[]),p=e=>{const{onlyGroupsIds:t,allItems:s}=e.reduce(((e,t)=>t.checked?(t.isGroup&&e.onlyGroupsIds.push(t.id),e.allItems.push(t),e):e),{onlyGroupsIds:[],allItems:[]});return s.filter((e=>!t.some((t=>t===e.childOf))))},m=(e,{id:t,isClosed:s})=>{e.filter((e=>e.childOf===t)).forEach((t=>{t.hidden=s??!1,t.isGroup&&!t.isClosed&&m(e,{id:t.id,isClosed:s})}))},v=(e,t)=>{const s=((e,t)=>e.reduce(((s,i)=>{if(i.name.toLowerCase().includes(t.toLowerCase())){if(s.push(i),i.isGroup){const t=h(i.id,e);s.push(...t)}if(i.childOf){const t=u(i.childOf,e);s.push(...t)}}return s}),[]))(e,t);e.forEach((t=>{s.some((e=>e.id===t.id))?(t.isGroup&&(t.isClosed=!1,m(e,t)),t.hidden=!1):t.hidden=!0}))},E=(e,t)=>{(e=>{e.forEach((e=>{e.checked=!1,e.isPartialChecked=!1}))})(t);t.filter((t=>e.some((e=>e===t.id)))).forEach((e=>{e.checked=!0,e.isPartialChecked=!1,d(e,t)}))},w=(e,t,s)=>{E(e,t),L(t,s)},L=(e,t)=>{e.forEach((s=>{const i=t.querySelector(`[input-id="${s.id}"]`),n=x(i);i.checked=s.checked,g(s,n),f(s,n),C(s,n),y(s,n),k(s,n,e),b(s,i)})),T(e,t)},g=(e,t)=>{e.checked?t.classList.add("treeselect-list__item--checked"):t.classList.remove("treeselect-list__item--checked")},f=(e,t)=>{e.isPartialChecked?t.classList.add("treeselect-list__item--partial-checked"):t.classList.remove("treeselect-list__item--partial-checked")},C=(e,t)=>{if(e.isGroup){const s=t.querySelector(".treeselect-list__item-icon");e.isClosed?(t.classList.add("treeselect-list__item--closed"),s.innerHTML=r.arrowRight):(t.classList.remove("treeselect-list__item--closed"),s.innerHTML=r.arrowDown)}},y=(e,t)=>{e.hidden?t.classList.add("treeselect-list__item--hidden"):t.classList.remove("treeselect-list__item--hidden")},b=(e,t)=>{const s=t.parentNode.querySelector(".treeselect-list__item-checkbox-icon");e.checked?s.innerHTML=r.check:e.isPartialChecked?s.innerHTML=r.partialCheck:s.innerHTML=""},k=(e,t,s)=>{if(0===e.level){const i=s.some((t=>t.isGroup&&t.level===e.level)),n=!e.isGroup&&i?"20px":"5px";t.style.paddingLeft=e.isGroup?"0":n}else t.style.paddingLeft=e.isGroup?20*e.level+"px":20*e.level+20+"px";t.setAttribute("level",e.level.toString()),t.setAttribute("group",e.isGroup.toString())},T=(e,t)=>{const s=e.some((e=>!e.hidden)),i=t.querySelector(".treeselect-list__empty");s?i.classList.add("treeselect-list__empty--hidden"):i.classList.remove("treeselect-list__empty--hidden")},x=e=>e.parentNode.parentNode;var _=class{#I=null;#M=!0;constructor({options:e,value:t,openLevel:s,listSlotHtmlComponent:i,emptyText:n}){this.options=e,this.value=t,this.openLevel=s??0,this.listSlotHtmlComponent=i??null,this.emptyText=n??"No results found...",this.searchText="",this.flattedOptions=o(this.options,this.openLevel),this.flattedOptionsBeforeSearch=this.flattedOptions,this.selectedNodes={nodes:[],groupedNodes:[]},this.srcElement=this.#S(),this.updateValue(this.value),(e=>{const{duplications:t}=e.reduce(((e,t)=>(e.allItems.some((e=>e===t.id))&&e.duplications.push(t.id),e.allItems.push(t.id),e)),{duplications:[],allItems:[]});t.length&&console.error(`Validation: You have duplicated values: ${t.join(", ")}! You should use unique values.`)})(this.flattedOptions)}updateValue(e){w(e,this.flattedOptions,this.srcElement),this.#H()}updateSearchValue(e){if(e===this.searchText)return;const t=""===this.searchText&&""!==e;this.searchText=e,t&&(this.flattedOptionsBeforeSearch=JSON.parse(JSON.stringify(this.flattedOptions))),""===this.searchText&&(this.flattedOptions=this.flattedOptionsBeforeSearch.map((e=>{const t=this.flattedOptions.find((t=>t.id===e.id));return t.isClosed=e.isClosed,t.hidden=e.hidden,t})),this.flattedOptionsBeforeSearch=[]),this.searchText&&v(this.flattedOptions,e),L(this.flattedOptions,this.srcElement),this.focusFirstListElement()}callKeyAction(e){this.#M=!1;const t=this.srcElement.querySelector(".treeselect-list__item--focused");"Enter"===e&&t&&t.dispatchEvent(new Event("mousedown")),"ArrowLeft"!==e&&"ArrowRight"!==e||this.#B(t,e),"ArrowDown"!==e&&"ArrowUp"!==e||this.#P(t,e)}focusFirstListElement(){const e="treeselect-list__item--focused",t=this.srcElement.querySelector(`.${e}`),s=Array.from(this.srcElement.querySelectorAll(".treeselect-list__item-checkbox")).filter((e=>"none"!==window.getComputedStyle(x(e)).display));if(!s.length)return;t&&t.classList.remove(e);x(s[0]).classList.add(e)}#B(e,t){if(!e)return;const s=e.querySelector(".treeselect-list__item-checkbox").getAttribute("input-id"),i=this.flattedOptions.find((e=>e.id===s)),n=e.querySelector(".treeselect-list__item-icon");"ArrowLeft"!==t||i.isClosed||n.dispatchEvent(new Event("mousedown")),"ArrowRight"===t&&i.isClosed&&n.dispatchEvent(new Event("mousedown"))}#P(e,t){const s=Array.from(this.srcElement.querySelectorAll(".treeselect-list__item-checkbox")).filter((e=>"none"!==window.getComputedStyle(x(e)).display));if(s.length)if(e){const e=s.findIndex((e=>x(e).classList.contains("treeselect-list__item--focused")));x(s[e]).classList.remove("treeselect-list__item--focused");const i="ArrowDown"===t?e+1:e-1,n="ArrowDown"===t?0:s.length-1,r=s[i]??s[n],l=!s[i],o=x(r);o.classList.add("treeselect-list__item--focused");const c=this.srcElement.getBoundingClientRect(),a=o.getBoundingClientRect();if(l&&"ArrowDown"===t)return void this.srcElement.scroll(0,0);if(l&&"ArrowUp"===t)return void this.srcElement.scroll(0,this.srcElement.scrollHeight);if(c.y+c.height<a.y+a.height)return void this.srcElement.scroll(0,this.srcElement.scrollTop+a.height);if(c.y>a.y)return void this.srcElement.scroll(0,this.srcElement.scrollTop-a.height)}else{x(s[0]).classList.add("treeselect-list__item--focused")}}#S(){const e=this.#N(),t=this.#G(this.options);e.append(...t);const s=this.#D();s&&e.append(s);const i=this.#z();return e.append(i),e}#N(){const e=document.createElement("div");return e.classList.add("treeselect-list"),e.addEventListener("mouseout",(e=>this.#q(e))),e.addEventListener("mousemove",(()=>this.#R())),e}#q(e){e.stopPropagation(),this.#I&&this.#M&&this.#I.classList.add("treeselect-list__item--focused")}#R(){this.#M=!0}#G(e){return e.reduce(((e,t)=>{if(t.children?.length){const s=this.#F(t),i=this.#G(t.children);return s.append(...i),e.push(s),e}const s=this.#V(t,!1);return e.push(s),e}),[])}#D(){if(!this.listSlotHtmlComponent)return null;const e=document.createElement("div");return e.classList.add("treeselect-list__slot"),e.appendChild(this.listSlotHtmlComponent),e}#z(){const e=document.createElement("div");e.classList.add("treeselect-list__empty"),e.setAttribute("title",this.emptyText);const t=document.createElement("span");t.classList.add("treeselect-list__empty-icon"),t.innerHTML=r.attention;const s=document.createElement("span");return s.classList.add("treeselect-list__empty-text"),s.innerHTML=this.emptyText,e.append(t,s),e}#F(e){const t=document.createElement("div");t.setAttribute("group-container-id",e.value),t.classList.add("treeselect-list__group-container");const s=this.#V(e,!0);return t.appendChild(s),t}#V(e,t){const s=this.#j(e);if(t){const e=this.#$();s.appendChild(e)}const i=this.#U(e),n=this.#W(e);return s.append(i,n),s}#j(e){const t=document.createElement("div");return t.setAttribute("tabindex","-1"),t.setAttribute("title",e.name),t.classList.add("treeselect-list__item"),t.addEventListener("mouseover",(()=>this.#K(t)),!0),t.addEventListener("mouseout",(()=>this.#Y(t)),!0),t.addEventListener("mousedown",(t=>this.#J(t,e))),t}#K(e){this.#M&&this.#X(!0,e)}#Y(e){this.#M&&(this.#X(!1,e),this.#I=e)}#J(e,t){e.stopPropagation();const s=e.target.querySelector(".treeselect-list__item-checkbox");s.checked=!s.checked,this.#Q(s,t)}#$(){const e=document.createElement("span");return e.setAttribute("tabindex","-1"),e.classList.add("treeselect-list__item-icon"),e.innerHTML=r.arrowDown,e.addEventListener("mousedown",(e=>this.#Z(e))),e}#Z(e){e.stopPropagation(),this.#ee(e)}#U(e){const t=document.createElement("div");t.classList.add("treeselect-list__item-checkbox-container");const s=document.createElement("span");s.classList.add("treeselect-list__item-checkbox-icon"),s.innerHTML="";const i=document.createElement("input");return i.setAttribute("tabindex","-1"),i.setAttribute("type","checkbox"),i.setAttribute("input-id",e.value),i.classList.add("treeselect-list__item-checkbox"),t.append(s,i),t}#W(e){const t=document.createElement("label");return t.innerHTML=e.name,t.classList.add("treeselect-list__item-label"),t}#Q(e,t){const s=this.flattedOptions.find((e=>e.id===t.value));s&&(s.checked=e.checked,s.isPartialChecked=!1,d(s,this.flattedOptions),L(this.flattedOptions,this.srcElement),this.#u())}#ee(e){const t=e.target?.parentNode?.querySelector("[input-id]"),s=t?.getAttribute("input-id"),i=this.flattedOptions.find((e=>e.id===s));i&&(i.isClosed=!i.isClosed,m(this.flattedOptions,i),L(this.flattedOptions,this.srcElement),this.#te())}#X(e,t){const s="treeselect-list__item--focused";if(e){const e=Array.from(this.srcElement.querySelectorAll(`.${s}`));e.length&&e.forEach((e=>e.classList.remove(s))),t.classList.add(s)}else t.classList.remove(s)}#H(){var e;this.selectedNodes={nodes:(e=this.flattedOptions,e.filter((e=>e.checked&&!e.isGroup))),groupedNodes:p(this.flattedOptions)}}#te(){this.srcElement.dispatchEvent(new CustomEvent("arrow-click"))}#u(){this.#H(),this.srcElement.dispatchEvent(new CustomEvent("input",{detail:this.selectedNodes}))}};const O=e=>e.map((e=>e.id));var A=class{#se=null;#ie=null;#ne=null;#re=null;#le=null;#oe=null;#ce=null;constructor({parentHtmlContainer:e,value:t,options:s,openLevel:i,appendToBody:n,alwaysOpen:r,showTags:l,tagsCountText:o,clearable:c,searchable:a,placeholder:d,grouped:h,listSlotHtmlComponent:u,disabled:p,emptyText:m,staticList:v}){(({parentHtmlContainer:e,staticList:t,appendToBody:s})=>{e||console.error("Validation: parentHtmlContainer prop is required!"),t&&s&&console.error("Validation: You should set staticList to false if you use appendToBody!")})({parentHtmlContainer:e,staticList:v,appendToBody:n}),this.parentHtmlContainer=e,this.value=t??[],this.options=s??[],this.openLevel=i??0,this.appendToBody=n??!0,this.alwaysOpen=!(!r||p),this.showTags=l??!0,this.tagsCountText=o??"elements selected",this.clearable=c??!0,this.searchable=a??!0,this.placeholder=d??"Search...",this.grouped=h??!0,this.listSlotHtmlComponent=u??null,this.disabled=p??!1,this.emptyText=m??"No results found...",this.staticList=!(!v||this.appendToBody),this.isListOpened=!1,this.srcElement=null,this.mount()}mount(){this.destroy();const{container:e,list:t,input:s}=this.#ae();this.srcElement=e,this.#se=t,this.#ie=s,this.#re=this.scrollWindowHandler.bind(this),this.#le=this.scrollWindowHandler.bind(this),this.#oe=this.focusWindowHandler.bind(this),this.#ce=this.blurWindowHandler.bind(this),this.alwaysOpen&&this.#ie?.openClose(),this.disabled&&this.srcElement.classList.add("treeselect--disabled")}updateValue(e){const t=this.#se;if(t){t.updateValue(e);const{groupedNodes:s,nodes:i}=t.selectedNodes,n=this.grouped?s:i;this.#ie?.updateValue(n)}}destroy(){this.srcElement&&(this.#de(),this.srcElement.innerHTML="",this.srcElement=null,this.#he(!0))}focus(){this.#ie&&this.#ie.focus()}toggleOpenClose(){this.#ie&&(this.#ie.openClose(),this.#ie.focus())}#ae(){const e=this.parentHtmlContainer;e.classList.add("treeselect");const t=new _({options:this.options,value:this.value,openLevel:this.openLevel,listSlotHtmlComponent:this.listSlotHtmlComponent,emptyText:this.emptyText}),{groupedNodes:s,nodes:i}=t.selectedNodes,n=new l({value:this.grouped?s:i,showTags:this.showTags,tagsCountText:this.tagsCountText,clearable:this.clearable,isAlwaysOpened:this.alwaysOpen,searchable:this.searchable,placeholder:this.placeholder,disabled:this.disabled});return this.appendToBody&&(this.#ne=new ResizeObserver((()=>this.updateListPosition()))),n.srcElement.addEventListener("input",(e=>this.#ue(e,t))),n.srcElement.addEventListener("open",(()=>this.#pe())),n.srcElement.addEventListener("keydown",(e=>this.#me(e,t))),n.srcElement.addEventListener("search",(e=>this.#ve(e,t))),n.srcElement.addEventListener("focus",(()=>this.#Ee()),!0),this.alwaysOpen||n.srcElement.addEventListener("close",(()=>this.#de())),t.srcElement.addEventListener("mouseup",(()=>n.focus()),!0),t.srcElement.addEventListener("input",(e=>this.#we(e,n))),t.srcElement.addEventListener("arrow-click",(()=>this.#Le(n))),e.append(n.srcElement),{container:e,list:t,input:n}}#ue(e,t){const s=O(e.detail);t.updateValue(s);const{nodes:i}=t.selectedNodes;this.value=O(i),this.#u()}#me(e,t){this.isListOpened&&t.callKeyAction(e.key)}#ve(e,t){t.updateSearchValue(e.detail),this.updateListPosition()}#Ee(){this.#ge(!0),this.#oe&&this.#oe&&this.#ce&&(document.addEventListener("mousedown",this.#oe,!0),document.addEventListener("focus",this.#oe,!0),window.addEventListener("blur",this.#ce))}#we(e,t){const{groupedNodes:s,nodes:i}=e.detail,n=this.grouped?s:i;t.updateValue(n),this.value=O(i),t.focus(),this.#u()}#Le(e){e.focus(),this.updateListPosition()}#pe(){this.isListOpened=!0,this.#re&&this.#le&&(window.addEventListener("scroll",this.#re,!0),window.addEventListener("resize",this.#le)),this.#se&&this.srcElement&&(this.appendToBody?(document.body.appendChild(this.#se.srcElement),this.#ne?.observe(this.srcElement)):this.srcElement.appendChild(this.#se.srcElement),this.updateListPosition(),this.#fe(!0),this.#se.focusFirstListElement())}#de(){if(this.isListOpened=!1,this.#re&&this.#le&&(window.removeEventListener("scroll",this.#re,!0),window.removeEventListener("resize",this.#le)),!this.#se||!this.srcElement)return;(this.appendToBody?document.body.contains(this.#se.srcElement):this.srcElement.contains(this.#se.srcElement))&&(this.appendToBody?(document.body.removeChild(this.#se.srcElement),this.#ne?.disconnect()):this.srcElement.removeChild(this.#se.srcElement),this.#fe(!1))}#Ce(e,t){if(!this.#se||!this.#ie)return;const s=t?"treeselect-list--top-to-body":"treeselect-list--top",i=t?"treeselect-list--bottom-to-body":"treeselect-list--bottom";e?(this.#se.srcElement.classList.add(s),this.#se.srcElement.classList.remove(i),this.#ie.srcElement.classList.add("treeselect-input--top"),this.#ie.srcElement.classList.remove("treeselect-input--bottom")):(this.#se.srcElement.classList.remove(s),this.#se.srcElement.classList.add(i),this.#ie.srcElement.classList.remove("treeselect-input--top"),this.#ie.srcElement.classList.add("treeselect-input--bottom"))}#ge(e){this.#ie&&this.#se&&(e?(this.#ie.srcElement.classList.add("treeselect-input--focused"),this.#se.srcElement.classList.add("treeselect-list--focused")):(this.#ie.srcElement.classList.remove("treeselect-input--focused"),this.#se.srcElement.classList.remove("treeselect-list--focused")))}#fe(e){e?this.#ie?.srcElement.classList.add("treeselect-input--opened"):this.#ie?.srcElement.classList.remove("treeselect-input--opened"),this.staticList?this.#se?.srcElement.classList.add("treeselect-list--static"):this.#se?.srcElement.classList.remove("treeselect-list--static")}#he(e){this.#re&&this.#le&&this.#oe&&this.#ce&&(this.alwaysOpen&&!e||(window.removeEventListener("scroll",this.#re,!0),window.removeEventListener("resize",this.#le)),document.removeEventListener("click",this.#oe,!0),document.removeEventListener("focus",this.#oe,!0),window.removeEventListener("blur",this.#ce))}scrollWindowHandler(){this.updateListPosition()}focusWindowHandler(e){this.srcElement?.contains(e.target)||this.#se?.srcElement.contains(e.target)||(this.#ie?.blur(),this.#he(!1),this.#ge(!1))}blurWindowHandler(){this.#ie?.blur(),this.#he(!1),this.#ge(!1)}updateListPosition(){const e=this.srcElement,t=this.#se?.srcElement;if(!e||!t)return;t.style.transform="";const{y:s,height:i}=t.getBoundingClientRect(),{x:n,y:r,height:l,width:o}=e.getBoundingClientRect(),c=window.innerHeight-r-l,a=r>c&&r>=i&&c<i;this.appendToBody&&(t.style.transform=a?`translateY(${r-s-i}px)`:`translateY(${r+l-s}px)`,t.style.width=`${o}px`,t.style.left=`${n+window.scrollX}px`);const d=a?"top":"bottom";t.getAttribute("direction")!==d&&(t.setAttribute("direction",d),this.#Ce(a,this.appendToBody))}#u(){this.srcElement?.dispatchEvent(new CustomEvent("input",{detail:this.value}))}};